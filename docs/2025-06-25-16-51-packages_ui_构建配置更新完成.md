# packages/ui æ„å»ºé…ç½®æ›´æ–°å®Œæˆ

## æ—¶é—´
2025-06-25 16:51:48

## æ“ä½œæ¦‚è¿°
æ›´æ–° @damon-stack/ui åŒ…çš„ package.json æ–‡ä»¶ï¼Œé…ç½®æ­£ç¡®çš„æ„å»ºè„šæœ¬å’Œå…¥å£ç‚¹ï¼Œä¸º TSUP æ„å»ºæµç¨‹åšå¥½å‡†å¤‡ã€‚

## æ‰§è¡Œæ­¥éª¤

### æ›´æ–°æ„å»ºè„šæœ¬
å°†å ä½ç¬¦è„šæœ¬æ›¿æ¢ä¸ºå®é™…çš„ TSUP å‘½ä»¤ï¼š

```json
"scripts": {
  "build": "tsup",
  "dev": "tsup --watch",
  "type-check": "tsc --noEmit"
}
```

#### è„šæœ¬è¯´æ˜
- **build**: æ‰§è¡Œç”Ÿäº§æ„å»ºï¼Œç”Ÿæˆ ESMã€CJS å’Œç±»å‹å®šä¹‰æ–‡ä»¶
- **dev**: å¼€å‘æ¨¡å¼ï¼Œå¯ç”¨æ–‡ä»¶ç›‘å¬ï¼Œå®æ—¶é‡æ–°æ„å»º
- **type-check**: TypeScript ç±»å‹æ£€æŸ¥ï¼Œä¸è¾“å‡ºæ–‡ä»¶

## å®Œæ•´ package.json é…ç½®åˆ†æ

### ğŸ“¦ åŒ…å…ƒä¿¡æ¯
```json
{
  "name": "@damon-stack/ui",
  "version": "0.1.0", 
  "description": "å…±äº« UI ç»„ä»¶åº“ï¼ŒåŸºäº Mantine UI æ¡†æ¶",
  "private": true
}
```

### ğŸ¯ å…¥å£ç‚¹é…ç½®
```json
{
  "main": "dist/index.js",        // CommonJS å…¥å£
  "module": "dist/index.mjs",     // ESM å…¥å£
  "types": "dist/index.d.ts"      // TypeScript ç±»å‹å®šä¹‰
}
```

### ğŸš€ ç°ä»£åŒ– exports å­—æ®µ
```json
{
  "exports": {
    ".": {
      "types": "./dist/index.d.ts",   // ç±»å‹ä¼˜å…ˆ
      "import": "./dist/index.mjs",   // ESM å¯¼å…¥
      "require": "./dist/index.js"    // CJS å¯¼å…¥
    }
  }
}
```

**ä¼˜åŠ¿**:
- æ”¯æŒ Node.js æ¡ä»¶å¯¼å‡º
- ç°ä»£æ‰“åŒ…å·¥å…·è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ ¼å¼
- å‘åå…¼å®¹ä¼ ç»Ÿæ„å»ºå·¥å…·

### ğŸ“ æ–‡ä»¶å‘å¸ƒé…ç½®
```json
{
  "files": ["dist"]
}
```

ç¡®ä¿å‘å¸ƒæ—¶åªåŒ…å«æ„å»ºäº§ç‰©ï¼Œä¸åŒ…å«æºç ã€‚

### ğŸ”— ä¾èµ–ç®¡ç†ç­–ç•¥

#### Peer Dependenciesï¼ˆå¯¹ç­‰ä¾èµ–ï¼‰
```json
{
  "peerDependencies": {
    "@mantine/core": "^8.0.0",
    "@mantine/hooks": "^8.0.0", 
    "react": "^18.0.0",
    "react-dom": "^18.0.0"
  }
}
```

**ä½œç”¨**: ç”±æ¶ˆè´¹åº”ç”¨æä¾›ï¼Œé¿å…é‡å¤å®‰è£…ï¼Œè§£å†³ Context é—®é¢˜ã€‚

#### Dev Dependenciesï¼ˆå¼€å‘ä¾èµ–ï¼‰
```json
{
  "devDependencies": {
    "@mantine/core": "^8.1.1",
    "@mantine/hooks": "^8.1.1",
    "react": "^19.1.0",
    "react-dom": "^19.1.0",
    "tsup": "^8.5.0",
    "typescript": "^5.0.0",
    "@types/react": "^18.0.0",
    "@types/react-dom": "^18.0.0"
  }
}
```

**ä½œç”¨**: 
- æœ¬åœ°å¼€å‘å’Œæ„å»ºæ—¶ä½¿ç”¨
- ä¸ä¼šå½±å“æ¶ˆè´¹åº”ç”¨çš„ä¾èµ–è§£æ
- ç¡®ä¿æ„å»ºè¿‡ç¨‹çš„ç‹¬ç«‹æ€§

## æŠ€æœ¯ç‰¹æ€§

### åŒæ ¼å¼æ”¯æŒ
- **CommonJS (dist/index.js)**: å…¼å®¹ Node.js å’Œä¼ ç»Ÿæ„å»ºå·¥å…·
- **ES Modules (dist/index.mjs)**: ç°ä»£ bundler å’Œ tree-shaking æ”¯æŒ

### TypeScript å®Œå…¨æ”¯æŒ
- **ç±»å‹å®šä¹‰ (dist/index.d.ts)**: å®Œæ•´çš„ TypeScript æ™ºèƒ½æç¤º
- **ç±»å‹æ£€æŸ¥è„šæœ¬**: å¼€å‘æ—¶ç±»å‹éªŒè¯

### å¼€å‘ä½“éªŒä¼˜åŒ–
- **Watch æ¨¡å¼**: å®æ—¶é‡æ„å»ºï¼Œæå‡å¼€å‘æ•ˆç‡
- **Source Maps**: è°ƒè¯•æ—¶æ˜ å°„åˆ°åŸå§‹æºç 
- **è¯¦ç»†æ„å»ºæ—¥å¿—**: é€æ˜çš„æ„å»ºè¿‡ç¨‹

## æ„å»ºæµç¨‹è¯´æ˜

### ç”Ÿäº§æ„å»ºæµç¨‹
1. æ‰§è¡Œ `pnpm build`
2. TSUP è¯»å– tsup.config.ts é…ç½®
3. æ¸…ç† dist ç›®å½•
4. ç¼–è¯‘ TypeScript æºç 
5. ç”Ÿæˆ ESMã€CJS åŒæ ¼å¼äº§ç‰©
6. ç”Ÿæˆç±»å‹å®šä¹‰æ–‡ä»¶
7. åº”ç”¨ä»£ç åˆ†å‰²å’Œä¼˜åŒ–

### å¼€å‘æ„å»ºæµç¨‹  
1. æ‰§è¡Œ `pnpm dev`
2. å¯åŠ¨æ–‡ä»¶ç›‘å¬æ¨¡å¼
3. æ–‡ä»¶å˜æ›´æ—¶è‡ªåŠ¨é‡æ–°æ„å»º
4. ä¿æŒå¢é‡ç¼–è¯‘æ€§èƒ½

## è§£å†³çš„å…³é”®é—®é¢˜

### 1. React Context è·¨åŒ…è®¿é—®
é€šè¿‡ external é…ç½®ç¡®ä¿ React ç”±ä¸»åº”ç”¨æä¾›ï¼Œé¿å…å¤šå®ä¾‹é—®é¢˜ã€‚

### 2. åŒ…æ ¼å¼å…¼å®¹æ€§
åŒæ ¼å¼è¾“å‡ºå…¼å®¹ä¸åŒçš„æ¨¡å—ç³»ç»Ÿå’Œæ„å»ºå·¥å…·ã€‚

### 3. TypeScript æ”¯æŒ
å®Œæ•´çš„ç±»å‹å®šä¹‰ç¡®ä¿ç±»å‹å®‰å…¨å’Œå¼€å‘ä½“éªŒã€‚

### 4. æ„å»ºä¼˜åŒ–
ä»£ç åˆ†å‰²ã€tree-shaking å’Œå‹ç¼©ä¼˜åŒ–æœ€ç»ˆåŒ…å¤§å°ã€‚

## ä¸‹ä¸€æ­¥å‡†å¤‡
- âœ… æ„å»ºè„šæœ¬å·²é…ç½®
- âœ… å…¥å£ç‚¹å·²å®šä¹‰
- âœ… ä¾èµ–ç­–ç•¥å·²ä¼˜åŒ–
- ğŸ”„ å‡†å¤‡æ‰§è¡Œé¦–æ¬¡æ„å»ºæµ‹è¯• 