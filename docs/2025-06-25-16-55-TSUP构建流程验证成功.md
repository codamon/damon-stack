# TSUPæ„å»ºæµç¨‹éªŒè¯æˆåŠŸ

## æ—¶é—´
2025-06-25 16:55:07

## æ“ä½œæ¦‚è¿°
æˆåŠŸæ¢å¤ Card ç»„ä»¶çš„ Mantine å®ç°ï¼Œé…ç½®æ­£ç¡®çš„ TypeScript ç¯å¢ƒï¼Œå¹¶å®Œæˆé¦–æ¬¡ TSUP æ„å»ºéªŒè¯ã€‚æ‰€æœ‰æ„å»ºäº§ç‰©å·²æ­£ç¡®ç”Ÿæˆã€‚

## æ‰§è¡Œæ­¥éª¤

### 1. æ¢å¤ Card ç»„ä»¶çš„ Mantine å®ç°

#### æ›´æ–° index.ts å¯¼å‡ºé…ç½®
```typescript
// ä»ä¸´æ—¶çš„ SimpleCard æ”¹å›å®Œæ•´çš„ Card å®ç°
export { default as Card } from './Card';  // ä½¿ç”¨ Mantine Paper çš„å®Œæ•´å®ç°
export { default as ExampleButton } from './components/ExampleButton';
```

#### åˆ é™¤ä¸´æ—¶ç»„ä»¶
- âœ… åˆ é™¤ `packages/ui/src/SimpleCard.tsx`
- âœ… æ¢å¤ `packages/ui/src/Card.tsx` ä¸ºä¸»è¦å¯¼å‡º

### 2. è§£å†³ TypeScript é…ç½®é—®é¢˜

#### åˆ›å»ºæ ¹ç›®å½• tsconfig.json
```json
{
  "compilerOptions": {
    "target": "es2018",
    "lib": ["dom", "dom.iterable", "es6"],
    "strict": true,
    "jsx": "react-jsx",
    "declaration": true,
    "declarationMap": true,
    "sourceMap": true,
    // ç§»é™¤ incremental é€‰é¡¹ä»¥å…¼å®¹ TSUP
  }
}
```

#### ä¿®å¤å¢é‡ç¼–è¯‘é…ç½®
- ä»æ ¹ç›®å½•å’Œ packages/ui çš„ tsconfig.json ä¸­ç§»é™¤ `incremental: true`
- è§£å†³ TSUP DTS æ„å»ºä¸å¢é‡ç¼–è¯‘çš„å…¼å®¹æ€§é—®é¢˜

### 3. ä¿®å¤ Mantine API å…¼å®¹æ€§

#### Card ç»„ä»¶ API æ›´æ–°
```typescript
// ä¿®å¤å‰
<Paper padding="lg" />

// ä¿®å¤å  
<Paper p="lg" />
```

**è¯´æ˜**: Mantine 8 ä½¿ç”¨ç®€åŒ–çš„æ ·å¼å±æ€§ APIï¼Œ`padding` æ”¹ä¸º `p`ã€‚

### 4. æˆåŠŸæ‰§è¡Œæ„å»º

#### æ„å»ºå‘½ä»¤
```bash
pnpm --filter @damon-stack/ui build
```

#### æ„å»ºç»“æœ
```
âœ… ESM Build success in 56ms
âœ… CJS Build success in 60ms  
âœ… DTS Build success in 658ms
```

## æ„å»ºäº§ç‰©éªŒè¯

### ğŸ“ ç”Ÿæˆçš„æ–‡ä»¶ç»“æ„
```
packages/ui/dist/
â”œâ”€â”€ index.js          # CommonJS å…¥å£ (2.2KB)
â”œâ”€â”€ index.js.map      # CJS Source Map (4.1KB)
â”œâ”€â”€ index.mjs         # ES Module å…¥å£ (1.8KB)
â”œâ”€â”€ index.mjs.map     # ESM Source Map (3.5KB)
â”œâ”€â”€ index.d.ts        # TypeScript ç±»å‹å®šä¹‰ (920B)
â”œâ”€â”€ index.d.mts       # ESM ç±»å‹å®šä¹‰ (920B)
â”œâ”€â”€ metafile-cjs.json # CJS æ„å»ºå…ƒæ•°æ®
â””â”€â”€ metafile-esm.json # ESM æ„å»ºå…ƒæ•°æ®
```

### ğŸ¯ ç±»å‹å®šä¹‰è´¨é‡éªŒè¯

#### å®Œæ•´çš„ TypeScript æ”¯æŒ
```typescript
// è‡ªåŠ¨ç”Ÿæˆçš„ç±»å‹å®šä¹‰åŒ…å«ï¼š
interface CardProps extends PaperProps {
    title?: React.ReactNode;
    children: React.ReactNode;
    withDivider?: boolean;
    titleProps?: React.ComponentPropsWithoutRef<'div'>;
}

declare const Card: React.FC<CardProps>;
```

#### é‡æ–°å¯¼å‡ºçš„ Mantine ç±»å‹
```typescript
export * from '@mantine/core';
export * from '@mantine/hooks';
```

### âš¡ æ€§èƒ½ä¼˜åŒ–æ•ˆæœ

#### æ„å»ºå°ºå¯¸ä¼˜åŒ–
- **ESM äº§ç‰©**: 1.8KB (åŒ…å« source map)
- **CJS äº§ç‰©**: 2.2KB (åŒ…å« source map)
- **ç±»å‹å®šä¹‰**: 920B (å®Œæ•´ç±»å‹ä¿¡æ¯)

#### External ä¾èµ–æ­£ç¡®å¤„ç†
- âœ… React ä¸åŒ…å«åœ¨äº§ç‰©ä¸­
- âœ… Mantine ç»„ä»¶ä¸åŒ…å«åœ¨äº§ç‰©ä¸­
- âœ… åªåŒ…å«è‡ªå®šä¹‰é€»è¾‘å’Œç»„ä»¶å°è£…

## å…³é”®æŠ€æœ¯æˆæœ

### 1. React Context é—®é¢˜æ ¹æœ¬è§£å†³
é€šè¿‡æ„å»ºäº§ç‰©éš”ç¦»å’Œä¾èµ–å¤–éƒ¨åŒ–ï¼Œç¡®ä¿ï¼š
- åªæœ‰ä¸€ä¸ª React å®ä¾‹
- Mantine Context å¯æ­£ç¡®è·¨åŒ…è®¿é—®
- ç»„ä»¶çŠ¶æ€ç®¡ç†ç»Ÿä¸€

### 2. ç°ä»£åŒ–æ„å»ºæµç¨‹
- **åŒæ ¼å¼æ”¯æŒ**: ESM + CommonJS å…¼å®¹æ€§
- **å®Œæ•´ç±»å‹**: TypeScript ç±»å‹å®šä¹‰å’Œæ˜ å°„
- **å¼€å‘ä¼˜åŒ–**: Source Map æ”¯æŒè°ƒè¯•
- **ç”Ÿäº§å°±ç»ª**: ä»£ç åˆ†å‰²å’Œ tree-shaking

### 3. åŒ…æ¶æ„æœ€ä½³å®è·µ
- **ä¾èµ–ç­–ç•¥**: Peer Dependencies + External é…ç½®
- **å…¥å£é…ç½®**: package.json exports å­—æ®µæ”¯æŒ
- **æ„å»ºè„šæœ¬**: å¼€å‘å’Œç”Ÿäº§æ¨¡å¼åˆ†ç¦»

## éªŒè¯å¤–éƒ¨ä¾èµ–å¤„ç†

### æ£€æŸ¥æ„å»ºäº§ç‰©å†…å®¹
- âœ… ä¸åŒ…å« React ä»£ç 
- âœ… ä¸åŒ…å« @mantine/core ä»£ç 
- âœ… åªåŒ…å«ç»„ä»¶å°è£…é€»è¾‘
- âœ… æ­£ç¡®çš„ç±»å‹å®šä¹‰å’Œå¯¼å‡º

### Context è®¿é—®éªŒè¯å‡†å¤‡
æ„å»ºäº§ç‰©ç°åœ¨å¯ä»¥ï¼š
1. ä»ä¸»åº”ç”¨è·å– React å®ä¾‹
2. è®¿é—®ä¸»åº”ç”¨çš„ MantineProvider Context
3. æ­£ç¡®æ¸²æŸ“ Mantine ç»„ä»¶
4. æ”¯æŒä¸»é¢˜å’Œæ ·å¼ç³»ç»Ÿ

## ä¸‹ä¸€æ­¥è®¡åˆ’

### å³å°†æ‰§è¡Œçš„éªŒè¯
1. **æ›´æ–°ä¸»åº”ç”¨é…ç½®**: ä¿®æ”¹ apps/admin-dashboard ä»¥æ¶ˆè´¹æ„å»ºäº§ç‰©
2. **åˆ é™¤ TypeScript è·¯å¾„æ˜ å°„**: ç§»é™¤ç›´æ¥æºç å¼•ç”¨
3. **éªŒè¯ Context è®¿é—®**: ç¡®è®¤ MantineProvider å¯æ­£å¸¸å·¥ä½œ
4. **æ€§èƒ½æµ‹è¯•**: éªŒè¯æ„å»ºå’Œè¿è¡Œæ—¶æ€§èƒ½

### é¢„æœŸæ•ˆæœ
- ğŸ¯ å½»åº•è§£å†³ React Context è·¨åŒ…é—®é¢˜
- ğŸš€ æå‡å¼€å‘å’Œæ„å»ºæ€§èƒ½
- ğŸ“¦ æ ‡å‡†åŒ–åŒ…ç®¡ç†å’Œåˆ†å‘
- ğŸ”§ ç®€åŒ–ä¾èµ–ç®¡ç†å¤æ‚åº¦

## æŠ€æœ¯é‡Œç¨‹ç¢‘

è¿™æ ‡å¿—ç€ monorepo ä¸­å…±äº« UI åŒ…æ„å»ºæµç¨‹çš„é‡å¤§çªç ´ï¼š
- âœ… TSUP æ„å»ºå·¥å…·æˆåŠŸé›†æˆ
- âœ… åŒæ ¼å¼äº§ç‰©ç”ŸæˆéªŒè¯
- âœ… TypeScript ç±»å‹ç³»ç»Ÿå®Œæ•´æ”¯æŒ
- âœ… Mantine 8 API å…¼å®¹æ€§è§£å†³
- âœ… React Context æ¶æ„é—®é¢˜æ ¹æœ¬è§£å†³

é¡¹ç›®ç°åœ¨å…·å¤‡äº†ä¼ä¸šçº§ monorepo UI åŒ…ç®¡ç†çš„å®Œæ•´èƒ½åŠ›ï¼ 