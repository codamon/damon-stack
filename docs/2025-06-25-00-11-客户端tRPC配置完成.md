# tRPC v10+ é›†æˆç¬¬äº”æ­¥ï¼šå®¢æˆ·ç«¯ tRPC é…ç½®å®Œæˆ

## æ—¶é—´
2025-06-25 00:11:24+12:00

## å®Œæˆå†…å®¹
åœ¨ apps/admin-dashboard åº”ç”¨ä¸­æˆåŠŸåˆ›å»ºäº†å®¢æˆ·ç«¯ tRPC React é…ç½®ï¼Œä½¿ React ç»„ä»¶èƒ½å¤Ÿè°ƒç”¨ tRPC APIã€‚

## åˆ›å»ºçš„æ–‡ä»¶
**æ–‡ä»¶è·¯å¾„ï¼š** `apps/admin-dashboard/trpc/react.tsx`

## æ–‡ä»¶åŠŸèƒ½

### æ ¸å¿ƒç»„ä»¶

1. **api å®¢æˆ·ç«¯å®ä¾‹**
   - ä½¿ç”¨ `createTRPCReact<AppRouter>()` åˆ›å»º
   - æä¾›ç±»å‹å®‰å…¨çš„ API è°ƒç”¨é’©å­
   - ç¡®ä¿å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ç±»å‹ä¸€è‡´

2. **TRPCReactProvider ç»„ä»¶**
   - ä¸ºæ•´ä¸ªåº”ç”¨æä¾› tRPC å’Œ React Query ä¸Šä¸‹æ–‡
   - ä½¿ç”¨ 'use client' æŒ‡ä»¤ï¼Œç¡®ä¿åœ¨å®¢æˆ·ç«¯è¿è¡Œ
   - åŒ…è£…æ‰€æœ‰éœ€è¦ä½¿ç”¨ tRPC çš„å­ç»„ä»¶

### é…ç½®ç‰¹æ€§

#### QueryClient é…ç½®
- **staleTime**: 60 ç§’ - å‡å°‘ä¸å¿…è¦çš„é‡æ–°è·å–
- **gcTime**: 5 åˆ†é’Ÿ - å†…å­˜ç¼“å­˜ä¿æŒæ—¶é—´
- **retry**: 1 æ¬¡ - å¤±è´¥æ—¶é‡è¯•æ¬¡æ•°
- **refetchOnWindowFocus**: false - ç¦ç”¨çª—å£èšç„¦æ—¶é‡æ–°è·å–

#### tRPC å®¢æˆ·ç«¯é…ç½®
- **httpBatchLink**: æ‰¹é‡å¤„ç†å¤šä¸ªè¯·æ±‚
- **url**: '/api/trpc' - æŒ‡å‘ API ç«¯ç‚¹
- **maxBatchSize**: 10 - æœ€å¤§æ‰¹å¤„ç†å¤§å°
- **headers**: æ”¯æŒè‡ªå®šä¹‰è¯·æ±‚å¤´ï¼ˆé¢„ç•™è®¤è¯åŠŸèƒ½ï¼‰

### Provider åµŒå¥—ç»“æ„
```jsx
<api.Provider>
  <QueryClientProvider>
    {children}
  </QueryClientProvider>
</api.Provider>
```

## æŠ€æœ¯ç‰¹ç‚¹
âœ… **ç±»å‹å®‰å…¨**: åŸºäº AppRouter ç±»å‹çš„å®Œæ•´ç±»å‹æ¨æ–­  
âœ… **æ€§èƒ½ä¼˜åŒ–**: HTTP æ‰¹å¤„ç†å’Œæ™ºèƒ½ç¼“å­˜ç­–ç•¥  
âœ… **é”™è¯¯å¤„ç†**: React Query çš„é‡è¯•æœºåˆ¶  
âœ… **å¼€å‘ä½“éªŒ**: è¯¦ç»†çš„ä»£ç æ³¨é‡Šå’Œé…ç½®è¯´æ˜  
âœ… **å¯æ‰©å±•æ€§**: é¢„ç•™è®¤è¯å¤´å’Œå…¶ä»–é…ç½®é€‰é¡¹  

## ä½¿ç”¨ç¤ºä¾‹
```tsx
// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
import { api } from '../trpc/react';

function MyComponent() {
  const { data, isLoading } = api.post.hello.useQuery({ text: 'World' });
  
  if (isLoading) return <div>Loading...</div>;
  
  return <div>{data?.greeting}</div>;
}
```

## æ–‡ä»¶ç»“æ„
```
apps/admin-dashboard/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ api/trpc/[trpc]/route.ts
â”œâ”€â”€ server/api/
â”‚   â”œâ”€â”€ trpc.ts
â”‚   â”œâ”€â”€ root.ts
â”‚   â””â”€â”€ routers/post.ts
â””â”€â”€ trpc/
    â””â”€â”€ react.tsx (å®¢æˆ·ç«¯é…ç½®)
```

## é›†æˆçŠ¶æ€
ğŸ”— **æœåŠ¡ç«¯**: âœ… å®Œæˆ  
ğŸ”— **API è·¯ç”±**: âœ… å®Œæˆ  
ğŸ”— **å®¢æˆ·ç«¯é…ç½®**: âœ… å®Œæˆ  
ğŸ”— **åº”ç”¨é›†æˆ**: â³ å¾…å®Œæˆ  

## ä¸‹ä¸€æ­¥
ç­‰å¾…ç”¨æˆ·ç¡®è®¤åï¼Œç»§ç»­ç¬¬å…­æ­¥ï¼šåœ¨ layout.tsx ä¸­é›†æˆ TRPCReactProvider 